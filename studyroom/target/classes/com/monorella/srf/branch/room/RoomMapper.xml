<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.monorella.srf.branch.room.RoomMapper">
	
	<!-- 열람석 등록 -->
	<insert id="insertSeat" parameterType="com.monorella.srf.branch.dto.Seat">
		INSERT INTO branch_saet_tb(
			room_cd
			, branch_owner_cd
			, seat_cnumber
			, colseat_state
			, seat_appoint)
		VALUES (
		#{room_cd}
		, #{branch_owner_cd}
		, #{seat_cnumber}
		, '빈좌석'
		, 'N')
	</insert>
	
	
	<!-- 열람실 등록 -->
	<insert id="insertMember" parameterType="com.monorella.srf.branch.dto.Room">
			<selectKey resultType="String" keyProperty="room_cd" order="BEFORE">
				SELECT CONCAT('room_cd', MAX(CONVERT(SUBSTRING(room_cd, 8), UNSIGNED))+1) as room_cd
				FROM branch_saet_tb
			</selectKey>
		INSERT INTO branch_room_tb(
		room_cd
		, branch_owner_cd
		, room_nm
		, seat_num
		, room_division)
		VALUES (
		#{room_cd} 
		, #{branch_owner_cd}
		, #{room_nm}
		, #{seat_num}
		, #{room_division})	
	</insert>
  </mapper>